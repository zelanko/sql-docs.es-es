---
title: Qué hace el administrador de controladores | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 07ab0784e6f6ad4487a02a179a5fa3be2617c930
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/27/2020
ms.locfileid: "81306566"
---
# <a name="what-the-driver-manager-does"></a>Lo que hace el Administrador de controladores
En la tabla siguiente se resume el modo en que el administrador de controladores ODBC *3. x* asigna las llamadas a los controladores ODBC *2. x* y ODBC *3. x* .  
  
|Función o<br /><br /> atributo de instrucción|Comentarios|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Apunta al marcador que se va a usar con **SQLFetchScroll**. Estos son los detalles de la implementación:<br /><br /> -Cuando una aplicación lo establece en un controlador ODBC *2. x* , el administrador de controladores ODBC *3. x* lo almacena en caché. Desreferencia el puntero y pasa el valor al controlador ODBC *2. x* en el argumento *FetchOffset* de **SQLExtendedFetch** cuando la aplicación llama a **SQLFetchScroll** más tarde.<br />-Cuando una aplicación lo establece en un controlador ODBC *3. x* , el administrador de controladores ODBC *3. x* pasa la llamada al controlador.|  
|SQL_ATTR_ROW_STATUS_PTR|Apunta a la matriz de estado de fila rellena por **SQLFetch**, **SQLFetchScroll**, **SQLBulkOperations**y **SQLSetPos**. Estos son los detalles de la implementación:<br /><br /> -Cuando una aplicación lo establece en un controlador ODBC *2. x* , el administrador de controladores ODBC *3. x* almacena en caché su valor. Pasa este valor al controlador ODBC *2. x* en el argumento *RowStatusArray* de **SQLExtendedFetch** cuando se llama a **SQLFetchScroll** o **SQLFetch** .<br />-Cuando una aplicación lo establece en un controlador ODBC *3. x* , el administrador de controladores ODBC *3. x* pasa la llamada al controlador.<br />-In State S6, si una aplicación establece SQL_ATTR_ROW_STATUS_PTR y después llama a **SQLBulkOperations** (con una *operación* de SQL_ADD) o **SQLSetPos** sin llamar primero a **SQLFETCH** o **SQLFetchScroll**, se devuelve SQLSTATE HY011 (el atributo no se puede establecer ahora).|  
|SQL_ATTR_ROWS_FETCHED_PTR|Apunta al búfer en el que **SQLFetch** y **SQLFetchScroll** devuelven el número de filas recuperadas. Estos son los detalles de la implementación:<br /><br /> -Cuando una aplicación lo establece en un controlador ODBC *2. x* , el administrador de controladores ODBC *3. x* almacena en caché su valor. Pasa este valor al controlador ODBC *2. x* en el argumento *RowCountPtr* de **SQLExtendedFetch** cuando la aplicación llama a **SQLFetch** o **SQLFetchScroll** .<br />-Cuando una aplicación lo establece en un controlador ODBC *3. x* , el administrador de controladores ODBC *3. x* pasa la llamada al controlador.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Establece el tamaño del conjunto de filas. Estos son los detalles de la implementación:<br /><br /> -Cuando una aplicación lo establece en un controlador ODBC *2. x* , el administrador de controladores ODBC *3. x* lo asigna al atributo de instrucción SQL_ROWSET_SIZE.<br />-Cuando una aplicación lo establece en un controlador ODBC *3. x* , el administrador de controladores ODBC *3. x* pasa la llamada al controlador.<br />-Cuando una aplicación que trabaja con un controlador ODBC *3. x* llama a **SQLSetScrollOptions**, SQL_ROWSET_SIZE se establece en el valor del argumento *RowsetSize* si el controlador subyacente no admite **SQLSetScrollOptions**.|  
|SQL_ROWSET_SIZE|Establece el tamaño del conjunto de filas usado por **SQLExtendedFetch** cuando una aplicación ODBC *2. x* llama a **SQLExtendedFetch** . Estos son los detalles de la implementación:<br /><br /> -Cuando una aplicación establece esto, el administrador de controladores ODBC *3. x* pasa la llamada al controlador, independientemente de la versión del controlador.<br />-Cuando una aplicación que trabaja con un controlador ODBC *2. x* llama a **SQLSetScrollOptions**, SQL_ROWSET_SIZE se establece en el valor del argumento **RowsetSize** .|  
|**SQLBulkOperations**|Realiza una operación de inserción, actualización, eliminación o captura mediante operaciones de marcador. Estos son los detalles de la implementación:<br /><br /> -Cuando una aplicación llama a **SQLBulkOperations** con una *operación* de SQL_ADD en un controlador ODBC *2. x* , el administrador de controladores ODBC *3. x* lo asigna a **SQLSetPos** con una *operación* de SQL_ADD.<br />-Cuando se trabaja con un controlador ODBC *2. x* que no admite **SQLSetPos** con una *operación* de SQL_ADD, el administrador de controladores ODBC *3. x* no asigna **SQLSetPos** con una *operación* de SQL_ADD a **SQLBulkOperations** con una *operación* de SQL_ADD. Esto se debe a que no se puede llamar a **SQLBulkOperations** en el estado S7, que en ODBC *2. x* era el único estado en el que se podía llamar a **SQLSetPos** .<br />-Si la aplicación llama a **SQLBulkOperations** con una *operación* de SQL_ADD en un controlador ODBC *2. x* antes de llamar a **SQLFetchScroll**, el administrador de controladores ODBC *3. x* devuelve un error.|  
|**SQLExtendedFetch**|Devuelve el conjunto de filas especificado. A excepción de la restricción que se acaba de anotar, el administrador de controladores ODBC *3. x* pasa las llamadas a **SQLExtendedFetch** al controlador, independientemente de la versión del controlador.|  
|**SQLFetch**|Devuelve el conjunto de filas siguiente. Estos son los detalles de la implementación:<br /><br /> -Cuando una aplicación llama a **SQLFetch** en un controlador ODBC *2. x* , el administrador de controladores ODBC *3. x* lo asigna a **SQLExtendedFetch**. El argumento *FetchOrientation* de **SQLExtendedFetch** se establece en SQL_FETCH_NEXT. El administrador de controladores utiliza el valor almacenado en caché del atributo de instrucción SQL_ATTR_ROW_STATUS_PTR para el argumento *RowStatusArray* y el valor almacenado en caché del atributo de instrucción SQL_ATTR_ROWS_FETCHED_PTR para el argumento *RowCountPtr* .<br />-Una aplicación ODBC *3. x* puede mezclar llamadas a **SQLFetch** y **SQLFetchScroll** en un controlador *ODBC 2. x* porque el administrador de controladores ODBC *3. x* asigna **SQLFETCH** a **SQLExtendedFetch** cuando una aplicación la llama en un controlador ODBC *2. x* .<br />-Si un controlador *ODBC 2. x* no es compatible **con SQLExtendedFetch**, el administrador de controladores ODBC *3. x* no asigna **SQLFetch** o **SQLFetchScroll** a **SQLExtendedFetch** cuando una aplicación lo llama en ese controlador. Si la aplicación intenta establecer SQL_ATTR_ROW_ARRAY_SIZE en un valor mayor que 1, se devuelve SQLSTATE HYC00 (característica opcional no implementada).<br />-Excepto en el caso de las restricciones que se acaban de anotar, el administrador de controladores ODBC *3. x* pasa las llamadas a **SQLFetch** al controlador, independientemente de la versión del controlador.|  
|**SQLFetchScroll**|Devuelve el conjunto de filas especificado. Estos son los detalles de la implementación:<br /><br /> -Cuando una aplicación llama a **SQLFetchScroll** en un controlador ODBC *2. x* , el administrador de controladores ODBC *3. x* lo asigna a **SQLExtendedFetch**. Usa el valor almacenado en caché del atributo de instrucción SQL_ATTR_ROW_STATUS_PTR para el argumento *RowStatusArray* y el valor almacenado en caché del atributo de instrucción SQL_ATTR_ROWS_FETCHED_PTR para el argumento *RowCountPtr* . Si el argumento *FetchOrientation* de **SQLFetchScroll** es SQL_FETCH_BOOKMARK, utiliza el valor almacenado en caché del atributo de instrucción SQL_ATTR_FETCH_BOOKMARK_PTR para el argumento *FetchOffset* y devuelve un error si el argumento *FetchOffset* de **SQLFetchScroll** no es 0.<br />-Cuando una aplicación llama a este en un controlador ODBC *3. x* , el administrador de controladores ODBC *3. x* pasa la llamada al controlador.|  
|**SQLSetPos**|Realiza varias operaciones de posición. El administrador de controladores ODBC *3. x* pasa las llamadas a **SQLSetPos** al controlador, independientemente de la versión del controlador.|  
|**SQLSetScrollOptions**|Cuando el administrador de controladores asigna **SQLSetScrollOptions** para una aplicación que trabaja con un controlador ODBC *3. x* que no admite **SQLSetScrollOptions**, el administrador de controladores establece la opción de instrucción SQL_ROWSET_SIZE, no el atributo de instrucción SQL_ATTR_ROW_ARRAY_SIZE, en el argumento *RowsetSize* de **SQLSetScrollOption**. Como resultado, una aplicación no puede usar **SQLSetScrollOptions** al capturar varias filas mediante una llamada a **SQLFetch** o **SQLFetchScroll**. Solo se puede usar al capturar varias filas mediante una llamada a **SQLExtendedFetch**.|
